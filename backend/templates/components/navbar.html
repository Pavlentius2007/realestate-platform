{# –ü—Ä–æ—Å—Ç–æ–µ –º–µ–Ω—é –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ—á–∫—É #}
<nav class="navbar">
  <div class="container">
    <!-- –õ–µ–≤—ã–π –±–ª–æ–∫: –ª–æ–≥–æ—Ç–∏–ø -->
    <a href="/{{ lang }}" class="logo">
      <i class="fa-solid fa-house"></i> SIANORO
    </a>
    
    <!-- –¶–µ–Ω—Ç—Ä: –ø—Ä–æ—Å—Ç–æ–µ –º–µ–Ω—é -->
    <ul class="nav-menu">
      <li>
        <a href="/{{ lang }}/properties?deal_type=buy">{{ _('navigation.buy_property') or '–ö—É–ø–∏—Ç—å' }}</a>
      </li>
      <li>
        <a href="/{{ lang }}/rent">{{ _('navigation.rent_property') or '–°–Ω—è—Ç—å' }}</a>
      </li>
      <li>
        <a href="/{{ lang }}/projects">{{ _('navigation.new_builds') or '–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏' }}</a>
      </li>
      <li>
        <a href="#" onclick="event.preventDefault(); openAiSearchModal();">{{ _('navigation.ai_assistant') or '–ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç' }}</a>
      </li>
      {% set show_calculator = false %}
      {% if request.url.path.startswith('/' ~ lang ~ '/projects') %}
        {% set show_calculator = true %}
      {% elif request.url.path.startswith('/' ~ lang ~ '/properties') and request.query_params.get('deal_type') == 'buy' %}
        {% set show_calculator = true %}
      {% endif %}
      {% if show_calculator %}
        <li>
          <a href="#" class="calculator-btn" onclick="openInvestmentCalculatorModal()">
            üí∞ {{ _('navigation.calculator') or '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä' }}
          </a>
        </li>
      {% endif %}
      <li>
        <a href="/{{ lang }}/articles">{{ _('navigation.useful') or '–°—Ç–∞—Ç—å–∏' }}</a>
      </li>
    </ul>
    
    <!-- –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
    <div class="language-switcher">
      <select id="language-switcher">
        <option value="en" {% if lang == 'en' %}selected{% endif %}>EN</option>
        <option value="ru" {% if lang == 'ru' %}selected{% endif %}>RU</option>
        <option value="th" {% if lang == 'th' %}selected{% endif %}>TH</option>
        <option value="zh" {% if lang == 'zh' %}selected{% endif %}>‰∏≠Êñá</option>
      </select>
    </div>
    
    <!-- –ú–æ–±–∏–ª—å–Ω—ã–π –±—É—Ä–≥–µ—Ä -->
    <button id="navbar-burger" class="mobile-burger">
      <i class="fa-solid fa-bars"></i>
    </button>
  </div>
  
  <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
  <div id="mobile-menu" class="mobile-menu">
    <ul>
      <li><a href="/{{ lang }}/properties?deal_type=buy">{{ _('navigation.buy_property') or '–ö—É–ø–∏—Ç—å' }}</a></li>
      <li><a href="/{{ lang }}/rent">{{ _('navigation.rent_property') or '–°–Ω—è—Ç—å' }}</a></li>
      <li><a href="/{{ lang }}/projects">{{ _('navigation.new_builds') or '–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏' }}</a></li>
      <li><a href="#" onclick="event.preventDefault(); openAiSearchModal();">{{ _('navigation.ai_assistant') or '–ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç' }}</a></li>
      <li><a href="#" onclick="event.preventDefault(); openInvestmentCalculator();">üí∞ {{ _('navigation.calculator') or '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä' }}</a></li>
      <li><a href="/{{ lang }}/articles">{{ _('navigation.useful') or '–°—Ç–∞—Ç—å–∏' }}</a></li>
      <li>
        <select id="mobile-language-switcher">
          <option value="en" {% if lang == 'en' %}selected{% endif %}>EN</option>
          <option value="ru" {% if lang == 'ru' %}selected{% endif %}>RU</option>
          <option value="th" {% if lang == 'th' %}selected{% endif %}>TH</option>
          <option value="zh" {% if lang == 'zh' %}selected{% endif %}>‰∏≠Êñá</option>
        </select>
      </li>
    </ul>
  </div>
</nav>

<script>
// –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
document.addEventListener('DOMContentLoaded', function() {
  const burger = document.getElementById('navbar-burger');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (burger && mobileMenu) {
    burger.addEventListener('click', function() {
      mobileMenu.classList.toggle('show');
    });
  }
  
  // –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
  const languageSwitcher = document.getElementById('language-switcher');
  const mobileLangSwitcher = document.getElementById('mobile-language-switcher');
  
  function switchLanguage(lang) {
    const currentPath = window.location.pathname;
    const pathParts = currentPath.split('/').filter(part => part !== '');
    
    // –£–±–∏—Ä–∞–µ–º —Ç–µ–∫—É—â–∏–π —è–∑—ã–∫ –∏–∑ –ø—É—Ç–∏
    if (pathParts.length > 0 && ['en', 'ru', 'th', 'zh'].includes(pathParts[0])) {
      pathParts.shift();
    }
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø—É—Ç—å —Å –Ω–æ–≤—ã–º —è–∑—ã–∫–æ–º
    const newPath = '/' + lang + (pathParts.length > 0 ? '/' + pathParts.join('/') : '');
    window.location.href = newPath;
  }
  
  if (languageSwitcher) {
    languageSwitcher.addEventListener('change', function() {
      switchLanguage(this.value);
    });
  }
  
  if (mobileLangSwitcher) {
    mobileLangSwitcher.addEventListener('change', function() {
      switchLanguage(this.value);
    });
  }
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
function openInvestmentCalculator() {
  const modal = document.getElementById('investment-calculator-modal');
  if (modal) {
    modal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  }
}
</script> 